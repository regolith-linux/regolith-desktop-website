<!doctype html><html lang=en dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  Introduction
  #

Regolith is a modern desktop environment designed to let you work faster by reducing unnecessary clutter and ceremony. It offers a keyboard based workflow and a tiling window manager that allows efficient management of windows, monitors and workspaces. Built on top of Ubuntu, GNOME Flashback, and i3, Regolith stands on a well-supported and consistent foundation.
In its current implementation, the use i3 window manager binds Regolith to X11. While X11 is fairly mature, it was never built for modern systems and is based on assumptions that are valid only for computers of the ’90s. Some of the issues present in X11 based window managers are low framerates, poor support for HiDPi panels, higher latency, screen tearing etc. Wayland is a display protocol that is written from scratch and aims at simplicity and extensibility Wayland has been in development for quite some time now and its implementations are now stable enough to be considered for daily usage. In fact, many desktop environments like gnome are now providing their wayland implementations as default. Sway window manager was introduced as a drop-in replacement for i3. It is based on wayland and is devoid of most of the issues present in X11 based window managers and compositors."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://regolith-desktop.com/posts/sway_integration_gsoc/"><meta property="og:site_name" content="Regolith Desktop"><meta property="og:title" content="Foundations for Regolith on Wayland (GSoC'22)"><meta property="og:description" content="Introduction # Regolith is a modern desktop environment designed to let you work faster by reducing unnecessary clutter and ceremony. It offers a keyboard based workflow and a tiling window manager that allows efficient management of windows, monitors and workspaces. Built on top of Ubuntu, GNOME Flashback, and i3, Regolith stands on a well-supported and consistent foundation.
In its current implementation, the use i3 window manager binds Regolith to X11. While X11 is fairly mature, it was never built for modern systems and is based on assumptions that are valid only for computers of the ’90s. Some of the issues present in X11 based window managers are low framerates, poor support for HiDPi panels, higher latency, screen tearing etc. Wayland is a display protocol that is written from scratch and aims at simplicity and extensibility Wayland has been in development for quite some time now and its implementations are now stable enough to be considered for daily usage. In fact, many desktop environments like gnome are now providing their wayland implementations as default. Sway window manager was introduced as a drop-in replacement for i3. It is based on wayland and is devoid of most of the issues present in X11 based window managers and compositors."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-09-25T00:00:00+00:00"><meta property="article:modified_time" content="2025-01-30T15:40:13-05:00"><title>Foundations for Regolith on Wayland (GSoC'22) | Regolith Desktop</title>
<link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png><link rel=canonical href=https://regolith-desktop.com/posts/sway_integration_gsoc/><link rel=stylesheet href=/book.min.8eed976e9f494f81a07343fac24f6d5e391a1d3401e3e2d478a351e3edc8ee8b.css integrity="sha256-ju2Xbp9JT4Ggc0P6wk9tXjkaHTQB4+LUeKNR4+3I7os=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.da87395594c285671c0acbc7b694e6a33997a732ba4dfc45afe1b03ba03adc79.js integrity="sha256-2oc5VZTChWccCsvHtpTmozmXpzK6TfxFr+GwO6A63Hk=" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-H87N5GZVTN"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-H87N5GZVTN")</script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><img src=/regolith-logo.png alt="Regolith Desktop"></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul class=book-languages><li><input type=checkbox id=languages class=toggle>
<label for=languages class="flex justify-between"><a role=button class="flex align-center"><img src=/svg/translate.svg class=book-icon alt=Languages>
English</a></label><ul><li><a href=https://regolith-desktop.com/de/>German</a></li><li><a href=https://regolith-desktop.com/fr/>French</a></li><li><a href=https://regolith-desktop.com/ja/>Japanese</a></li></ul></li></ul><ul><li><span>Using Regolith</span><ul><li><a href=/docs/using-regolith/install/>Install</a></li><li><a href=/docs/using-regolith/first-launch/>First Launch</a></li><li><a href=/docs/using-regolith/basics/>Basic Usage</a></li><li><a href=/docs/using-regolith/configuration/>Configuration</a></li></ul></li><li><input type=checkbox id=section-f2146eb4a9759c56a2c4e929863ee4bf class=toggle>
<label for=section-f2146eb4a9759c56a2c4e929863ee4bf class="flex justify-between"><a href=/docs/howtos/>How To</a></label><ul><li><a href=/docs/howtos/customize-i3-configuration/>How to Customize i3 Configuration</a></li><li><a href=/docs/howtos/workspace-on-output/>Assign a workspace to a specific Output (Display)</a></li><li><a href=/docs/howtos/change-background/>Change background</a></li><li><a href=/docs/howtos/add-remove-blocklets/>Change Bar Status indicators</a></li><li><a href=/docs/howtos/replace-notification-system/>Change Notification Systems</a></li><li><a href=/docs/howtos/time-format/>Change the Bar Date and Time Format</a></li><li><a href=/docs/howtos/change-terminal/>Change the Default Terminal</a></li><li><a href=/docs/howtos/default-gap/>Change the Default Window Gap</a></li><li><a href=/docs/howtos/change-lockscreen/>Change the lock screen program</a></li><li><a href=/docs/howtos/terminal-font/>Change the Terminal Font Size</a></li><li><a href=/docs/howtos/change-workspace-icons/>Change Workspace Icons and Labels</a></li><li><a href=/docs/howtos/disable-unclutter/>Disable Mouse Hiding (unclutter)</a></li><li><a href=/docs/howtos/find-install-packages/>Find and Install Packages</a></li><li><a href=/docs/howtos/customize-compositor/>How to Customize Compositor</a></li><li><a href=/docs/howtos/hide-i3-bar-by-default/>How to Hide i3-bar by default</a></li><li><a href=/docs/howtos/install-sway/>Install the Sway Compositor</a></li><li><a href=/docs/howtos/floating-window/>Launch an app in a Floating Window</a></li><li><a href=/docs/howtos/vanilla-i3-gaps/>Launch Default i3 Session</a></li><li><a href=/docs/howtos/tdcli-blocklet/>Manage a To-Do List</a></li><li><a href=/docs/howtos/minimal-ubuntu-install/>Minimal Ubuntu Install</a></li><li><a href=/docs/howtos/override-xres/>Override Xresources</a></li><li><a href=/docs/howtos/remove-unneeded-deps/>Remove Unneeded Dependencies</a></li><li><a href=/docs/howtos/stage-configs/>Stage Config Files</a></li><li><a href=/docs/howtos/multiple-batteries/>Support Multiple Batteries</a></li><li><a href=/docs/howtos/gnome-flashback-session/>Verify behavior against upstream</a></li></ul></li><li><input type=checkbox id=section-4753aa88bb7780840312fdc16597ee0c class=toggle>
<label for=section-4753aa88bb7780840312fdc16597ee0c class="flex justify-between"><a href=/docs/reference/>Reference</a></label><ul><li><a href=/docs/reference/keybindings/>Keybindings</a></li><li><a href=/docs/reference/configurations/>Config Files</a></li><li><a href=/docs/reference/i3xrocks/>i3xrocks</a></li><li><a href=/docs/reference/xresources/>Xresources</a></li><li><input type=checkbox id=section-26cf73e0551136aab17cbd841872575b class=toggle>
<label for=section-26cf73e0551136aab17cbd841872575b class="flex justify-between"><a href=/docs/reference/Releases/>Releases</a></label><ul><li><a href=/docs/reference/Releases/regolith-3.2-release-notes/>3.2 Release Notes</a></li><li><a href=/docs/reference/Releases/regolith-3.1-release-notes/>3.1 Release Notes</a></li><li><a href=/docs/reference/Releases/regolith-3.0-release-notes/>3.0 Release Notes</a></li><li><a href=/docs/reference/Releases/regolith-2.2-release-notes/>2.2 Release Notes</a></li><li><a href=/docs/reference/Releases/regolith-2.1-release-notes/>2.1 Release Notes</a></li><li><a href=/docs/reference/Releases/regolith-2.0-release-notes/>2.0 Release Notes</a></li><li><a href=/docs/reference/Releases/regolith-1.6.0-release-notes/>1.6 Release Notes</a></li><li><a href=/docs/reference/Releases/regolith-1.5.3-release-notes/>1.5.3 Release Notes</a></li><li><a href=/docs/reference/Releases/regolith-1.5.2-release-notes/>1.5.2 Release Notes</a></li><li><a href=/docs/reference/Releases/regolith-1.5.1-release-notes/>1.5.1 Release Notes</a></li><li><a href=/docs/reference/Releases/regolith-1.5-release-notes/>1.5 Release Notes</a></li><li><a href=/docs/reference/Releases/regolith-1.4.1-release-notes/>1.4.1 Release Notes</a></li><li><a href=/docs/reference/Releases/regolith-1.4-release-notes/>1.4 Release Notes</a></li><li><a href=/docs/reference/Releases/regolith-1.3.1-release-notes/>1.3.1 Release Notes</a></li><li><a href=/docs/reference/Releases/regolith-1.3-release-notes/>1.3 Release Notes</a></li></ul></li><li><a href=/docs/reference/build-system/>Build System</a></li></ul></li></ul><ul><li><a href=/posts/>Blog</a></li><li><a href=https://github.com/orgs/regolith-linux/discussions target=_blank rel=noopener>Help & Discussion</a></li><li><a href=https://github.com/regolith-linux target=_blank rel=noopener>Github</a></li><li><a href=https://opencollective.com/regolith/donate target=_blank rel=noopener>Support Regolith<br><br><img src=https://badgen.net/opencollective/backers/regolith></a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu>
</label><strong>Foundations for Regolith on Wayland (GSoC'22)</strong>
<label for=toc-control></label></div></header><article class="markdown book-post"><h2>Foundations for Regolith on Wayland (GSoC'22)</h2><div class="flex align-center text-small book-post-date"><img src=/svg/calendar.svg class=book-icon alt>
<span>September 25, 2022</span></div><div class=book-post-content><h1 id=introduction>Introduction
<a class=anchor href=#introduction>#</a></h1><p>Regolith is a modern desktop environment designed to let you work faster by reducing unnecessary clutter and ceremony. It offers a keyboard based workflow and a tiling window manager that allows efficient management of windows, monitors and workspaces. Built on top of Ubuntu, GNOME Flashback, and i3, Regolith stands on a well-supported and consistent foundation.</p><p>In its current implementation, the use i3 window manager binds Regolith to X11. While X11 is fairly mature, it was never built for modern systems and is based on assumptions that are valid only for computers of the ’90s. Some of the issues present in X11 based window managers are low framerates, poor support for HiDPi panels, higher latency, screen tearing etc. Wayland is a display protocol that is written from scratch and aims at simplicity and extensibility Wayland has been in development for quite some time now and its implementations are now stable enough to be considered for daily usage. In fact, many desktop environments like gnome are now providing their wayland implementations as default. Sway window manager was introduced as a drop-in replacement for i3. It is based on wayland and is devoid of most of the issues present in X11 based window managers and compositors.</p><blockquote><p><strong>Note:</strong> The work described in this post was done as part of my <a href=https://summerofcode.withgoogle.com/>Google Summer of Code (GSoC) 2022</a> project under the organisation <a href=https://ccextractor.org/>CCExtractor</a>.</p></blockquote><h1 id=objective>Objective
<a class=anchor href=#objective>#</a></h1><p>The project intends to achieve integration of swaywm with the regolith ecosystem. This means, compatibility with GNOME services, integration of a configuration management system, theming using regolith look and support for other extras provided by regolith in a wayland-based environment.</p><h1 id=integrating-sway-with-regolith>Integrating sway with regolith
<a class=anchor href=#integrating-sway-with-regolith>#</a></h1><p>In this section, I will described everything that I did to achieve sway integration with regolith. This required modifying several existing packages as well as writing code for new scripts and binaries.</p><h2 id=porting-the-regolith-app-launcher-ilia-to-wayland>Porting the regolith app launcher (ilia) to wayland
<a class=anchor href=#porting-the-regolith-app-launcher-ilia-to-wayland>#</a></h2><p>After having a discussion with Ken, we decided that the most important part of a tiling window manager setup from a user&rsquo;s perspective is the app-launcher. Regolith on X11 ships with its own app launcher called <code>ilia</code>. It also provides several features apart from launching apps. This includes showing keybindings, launching terminal commands, list applications and workspaces and search files just to name a few.</p><p>Ilia is written in <code>vala</code> and <code>GTK</code>. This means, ilia had support for wayland right out of the box. Despite this inherent compatibility, ilia seemed to crash everytime. After looking into the logs, I realised that the issue was not with <code>ilia</code> but with the way <code>wayland roots</code> (wlr) handles windows that need to be ignored by the compositor. Turns out, wlr provides an extension to the wayland protocols called <code>wlr-layer-shell</code> in order to handle panels and other applications that need to be positioned automatically. A client implementation of this protocol for GTK based applications is provided by the library <code>gtk-layer-shell</code>. To maintain support for both <code>X11</code> and <code>wayland</code>, I check the <code>XDG_SESSION_TYPE</code> environment variable and use gtk-layer-shell library only if the session type is wayland.</p><p>Currently, the wayland compatible version of <code>ilia</code> is not packaged and exists in a <a href=https://github.com/regolith-linux/ilia/tree/ubuntu/jammy-wayland>seperate branch</a>.</p><h2 id=trawl---a-backend-agnostic-configuration-manager>Trawl - A backend agnostic configuration manager
<a class=anchor href=#trawl---a-backend-agnostic-configuration-manager>#</a></h2><p><code>Wayland</code> lacks support for <code>Xresources</code> natively and requires the use <code>XWayland</code>. This might not be desirable as it forces users to enable <code>Xwayland</code> forcing them to be a part of a legacy ecosystem. This is the reason why we decided to create a display backend agnostic configuration manager that can be used by various applications. To maintain compatibility with the existing regolith ecosystem it was crutial to replicate the format and functionaility XResources as much as possible. <code>Trawl</code> is a file based configuration management system written in rust that tries to fulfill these requirements.</p><p><a href=https://github.com/regolith-linux/trawl><code>Trawl</code></a> is comprised of two parts - Configuration Daemon (<code>trawld</code>) and Trawl Client (<code>trawldb</code>). For IPC, it uses the <code>DBus</code> specification, which allows other applications to access <code>trawl</code> resources with ease. In fact, trawl comes with libraries for <a href=https://github.com/regolith-linux/libtrawldb>C</a> and <a href=https://crates.io/crates/trawldb>rust</a> that make interaction with trawl clients hassle free. Trawl also tries to replicate most of the features provided by <code>Xresources</code> by replicating the functionality available using the <code>xrdb</code> CLI.</p><h2 id=sway---adding-the-set_from_resource-command>Sway - adding the set_from_resource command
<a class=anchor href=#sway---adding-the-set_from_resource-command>#</a></h2><p><code>Sway</code> aims to be a drop in alternative for <code>i3</code>. But there are some features which make sense only within the <code>X11</code> ecosystem, and one such feature is the <code>set_from_resource</code> command in the configs. This command allows users to set variables within the i3 configurations by querying <code>XResources</code> for specific keys. Due to the lack of <code>XResources</code> alternatives that are display backend agnostic, the creators of sway decided <a href=https://github.com/swaywm/sway/issues/2336#issuecomment-469041201>not to implement it</a>, even if its at the cost of breaking compatibility with i3 configurations.</p><p>Regolith relies heavily on <code>XResources</code> based configurations. This helps acheive functional configurations to some extent, such that you can replicate your window manager setup just by copying over your <code>XResources</code> and <code>config partials</code>. In order to maintain a consistent experience across the board, it was absolutely crutial to re-implement <code>set_from_resource</code> for sway.</p><p>I created a fork of sway called <a href=https://github.com/regolith-linux/sway-regolith><code>sway-regolith</code></a> which adds the <a href=https://github.com/regolith-linux/sway-regolith/blob/7d4bca923950db19bc3341d960ed5862339eb1b7/sway/commands.c#L87><code>set_from_resource</code></a> command. In order to communicate with the trawl demon, I used the wrapper functions provided by the <a href=https://github.com/regolith-linux/libtrawldb><code>libtrawldb</code></a> library, which provides several wrapper functions for the DBus methods. Finally, I renamed the <code>sway</code> binary to <code>sway-regolith</code> in order to allow the fork and the upstream versions of sway to co-exist.</p><h2 id=regolith-displayd>Regolith-displayd
<a class=anchor href=#regolith-displayd>#</a></h2><p>In regolith, the de facto way for managing and changing settings is the use of <code>gnome-control-center</code>. Since the displays are managed by <code>X11</code> in both <code>i3</code> and <code>Gnome on X11</code>, the display panel of <code>gnome-control-center</code> works right out of the box. However, in the case of wayland based compositors and window managers like <code>sway</code> and <code>mutter</code> on wayland, the diplays are managed by the compositor itself. So <code>gnome-control-center</code> can manage displays only when mutter is the compositor in use.</p><p>On looking into <code>gnome-control-center</code>&rsquo;s codebase, I discovered that the display settings are applied by communicating with the <code>org.mutter.DisplayConfig</code> DBus interface. So I created <a href=https://github.com/regolith-linux/regolith-displayd><code>regolith-displayd</code></a>, which creates a <code>DBus</code> interface with the same name. It primarily provides two DBus methods - <code>GetCurrentState</code> and <code>ApplyMonitorsConfig</code>. The <code>GetCurrentState</code> method gets the current configuration of monitors and maps it into a format understandable by <code>gnome-control-center</code>. Similarly, calls to the <code>ApplyMonitorsConfig</code> method applies the display settings changes made from <code>gnome-control-center</code> by mapping them into a format understandable by the IPC interface of sway.</p><p><code>regolith-displayd</code> also polls the sway IPC interface to check for changes in display configuration. If a change is detected, the <code>MonitorsChanged</code> signal is emmitted. <code>gnome-control-center</code> reacts to this message by making a call to <code>GetCurrentState</code>.</p><p>In order to achieve display configuration persistance, <code>regolith-displayd</code> generates <code>kanshi</code> profiles based on the displays that are currently in use. These configurations are then automatically applied whenever the same monitors are connected.</p><h2 id=regolith-session>Regolith-session
<a class=anchor href=#regolith-session>#</a></h2><p><code>regolith-session</code> package is probably the most important part of regolith as it essentially ties i3 with GNOME flashback. This package is also partly responsible for the <code>regolith-look</code> related functionality. The code for wayland version of the package can be found in the <a href=https://github.com/regolith-linux/regolith-session/tree/wayland-dev><code>wayland-dev</code></a> branch.</p><p>Migrating regolith-session to wayland required work on the following sections.</p><h3 id=session-initialization-script-regolith-session-wayland>Session initialization script (<code>regolith-session-wayland</code>)
<a class=anchor href=#session-initialization-script-regolith-session-wayland>#</a></h3><p><a href=https://github.com/regolith-linux/regolith-session/blob/c92813f5c836443ab0d85eb4e925a3aa2bbbfd2e/usr/bin/regolith-session-wayland>This</a> script is responsible for loading the <code>trawl</code> resources set by the user, loading current look information, reformatting pango markup for workspace names, registering the session with <code>gnome session manager</code> and launching sway with the regolith configuration file.</p><h3 id=usrshareapplicationsregolith-waylanddesktop><code>/usr/share/applications/regolith-wayland.desktop</code>
<a class=anchor href=#usrshareapplicationsregolith-waylanddesktop>#</a></h3><p><a href=https://github.com/regolith-linux/regolith-session/blob/c92813f5c836443ab0d85eb4e925a3aa2bbbfd2e/usr/share/applications/regolith-wayland.desktop>This</a> application file executes the <code>regolith-session-wayland</code> script. This application file will be read by <code>gnome-session-binary</code> while loading the Required Components from the session file.</p><h3 id=usrsharegnome-sessionsessionsregolith-waylandsession><code>/usr/share/gnome-session/sessions/regolith-wayland.session</code>
<a class=anchor href=#usrsharegnome-sessionsessionsregolith-waylandsession>#</a></h3><p><a href=https://github.com/regolith-linux/regolith-session/blob/c92813f5c836443ab0d85eb4e925a3aa2bbbfd2e/usr/share/gnome-session/sessions/regolith-wayland.session>This</a> file lists out the components required by the session in order to work correctly. If all the required components cannot be loaded, the session ends abruptly with an error. Most of these components are <code>gnome-settings-daemon</code> plugins. If the session is loaded using <code>gnome-session --builtin</code>, it launches the required components using their respective application files instead of launching their systemd services. The <code>regolith-sway</code> desktop file is also included in the required components section which launches ultimately starts the regolith session.</p><h3 id=usrsharewayland-sessionsregolith-swaydektop><code>/usr/share/wayland-sessions/regolith-sway.dektop</code>
<a class=anchor href=#usrsharewayland-sessionsregolith-swaydektop>#</a></h3><p><a href=https://github.com/regolith-linux/regolith-session/blob/c92813f5c836443ab0d85eb4e925a3aa2bbbfd2e/usr/share/wayland-sessions/regolith-sway.desktop>This</a> file is read by the display manager / login manager and shows the entry <code>Regolith on Wayland</code> in the login screen. The command <code>/usr/bin/gnome-session --builtin --session=regolith-wayland</code> is executed as soon as you login. This command looks for <code>/usr/share/gnome-session/sessions/regolith-wayland.session</code> and loads the required components.</p><h3 id=usrlibregolithregolith-session-commonsh><code>/usr/lib/regolith/regolith-session-common.sh</code>
<a class=anchor href=#usrlibregolithregolith-session-commonsh>#</a></h3><p><a href=https://github.com/regolith-linux/regolith-session/blob/c92813f5c836443ab0d85eb4e925a3aa2bbbfd2e/usr/lib/regolith/regolith-session-common.sh>This</a> provides functionality that is used in multiple scripts (related to both <code>X11</code> and <code>wayland</code> based sessions). It also contains some variables that are required by many of the scripts related to <code>regolith-session</code>. I&rsquo;ve added several functions and environment variables that are required to provide functionality equivalent to what is provided by Regolith on X11 sessions.</p><h3 id=regolith-look-script-usrbinregolith-look>Regolith look script (<code>/usr/bin/regolith-look</code>)
<a class=anchor href=#regolith-look-script-usrbinregolith-look>#</a></h3><p><a href=https://github.com/regolith-linux/regolith-session/blob/c92813f5c836443ab0d85eb4e925a3aa2bbbfd2e/usr/bin/regolith-look>This</a> provides theming related functionallity, which is one of the defining features of the regolith ecosystem. I&rsquo;ve added a check to determine if the current session type (X11 or Wayland). If the current session is wayland, <code>trawlcat</code> is used instead of <code>xrescat</code> and <code>swaymsg reload</code> is used instead of <code>i3-msg refresh</code>. When loading a look, if the current session is wayland, the configurations are loaded into <code>trawl</code> and if the session is X11, the resources are loaded using <code>xrdb</code> as XResources.</p><h2 id=regolith-look>Regolith Look
<a class=anchor href=#regolith-look>#</a></h2><p>The functionality of the <code>regolith-look</code> script (located at <code>/usr/bin/regolith-look</code>) has been discussed in the <a href=#regolith-look-script-usrbinregolith-look>previous section</a>. In order to apply the theme, a loader script is required. This can either be provided by the look or the user. If no loader is provided, the <a href=https://github.com/regolith-linux/regolith-look-default/blob/1d50b0797c579b239664a8a96aaf7de399f0f2da/usr/share/regolith-look/default_loader.sh>default loader script</a> (present in the <code>regolith-look-default</code> package) is used. To make this loader script compatible with <code>trawl</code> in wayland, I had to check if the current session is wayland and set the <code>RESOURCE_GETTER</code> variable to <code>trawlcat</code> accordingly.</p><p>Regolith also uses gnome-terminal by default. So in order to provide terminal theming in wayland, the <a href=https://github.com/regolith-linux/regolith-ftue/blob/2b2c1a9d73e93ebc67640876839ed853130f0e8e/regolith-init-term-profile><code>regolith-init-term-profile</code></a> script also needs to use <code>trawlcat</code> as resource getter. This script is responsible for changing the terminal profile theme.</p><h2 id=regolith-inputd>Regolith-inputd
<a class=anchor href=#regolith-inputd>#</a></h2><p>Similar to outut management, input management in wayland is also dependent on the compositor. This is the reason why changing input settings from <code>gnome-control-center</code> doesn&rsquo;t work out of the box. In order to get the input panel of gnome-control-center to work, I created <a href=https://github.com/regolith-linux/regolith-inputd><code>regolith-inputd</code></a>, which monitors the <code>gsettings</code> schema <a href=https://github.com/regolith-linux/regolith-inputd/blob/78349e1c9a77e4edcffbe5c245f8c58e138f90ea/org.gnome.desktop.peripherals.gschema.xml><code>org.gnome.desktop.peripherals</code></a>. This allows to map changes in input properties to sway configuration commands which are then applied using the <code>sway</code> IPC interface.</p><h1 id=whats-next>What&rsquo;s next?
<a class=anchor href=#whats-next>#</a></h1><p>You can track work related sway integration in <a href=https://github.com/orgs/regolith-linux/projects/8>this</a> GitHub projects page. All contributions are more than welcome. I have really enjoyed working on this project and I plan to continue even after I&rsquo;m done with the final evaluation for Google Summer of Code.</p><h1 id=what-doesnt-work>What doesn&rsquo;t work
<a class=anchor href=#what-doesnt-work>#</a></h1><ul><li>Lock Screen (Alternatives - swaylock)</li><li>GNOME OSD overlays (Alternatives - wob)</li><li>GNOME flashback / gnome-shell-related stuff</li><li>Using any Display Manager other than GDM 3 causes issues</li><li>swaybar status (requires several reloads to work properly)</li><li>ilia keybindings page</li><li><code>gnome-session-quit</code> popup</li></ul></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/regolith-linux/regolith-desktop-website/commit/c64e4e045620460a53e57ae23924d18b035fb956 title='Last modified by Khosrow Moossavi | January 30, 2025' target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt>
<span>January 30, 2025</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div></main></body></html>